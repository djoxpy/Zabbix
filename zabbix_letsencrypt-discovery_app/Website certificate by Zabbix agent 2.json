{
    "zabbix_export": {
        "version": "7.0",
        "template_groups": [
            {
                "uuid": "a571c0d144b14fd4a87a9d9b2aa9fcd6",
                "name": "Templates/Applications"
            }
        ],
        "templates": [
            {
                "uuid": "5630ec1b1baf449abe1bc5521f85fe6c",
                "template": "Website certificate by Zabbix agent 2",
                "name": "Website certificate by Zabbix agent 2",
                "description": "The template to monitor TLS/SSL certificate on the website by Zabbix agent 2 that works without any external scripts.\n\nZabbix agent 2 with the WebCertificate plugin requests certificate using the web.certificate.get key and returns JSON with certificate attributes.\n\nYou can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/428309-discussion-thread-for-official-zabbix-template-tls-ssl-certificates-monitoring\n\nGenerated by official Zabbix template tool \"Templator\"",
                "vendor": {
                    "name": "Zabbix",
                    "version": "7.0-0"
                },
                "groups": [
                    {
                        "name": "Templates/Applications"
                    }
                ],
                "discovery_rules": [
                    {
                        "uuid": "a17fd32017a54a47b93b25a7e15fb996",
                        "name": "Site discovery",
                        "key": "letsencrypt.discovery",
                        "delay": "1h",
                        "item_prototypes": [
                            {
                                "uuid": "a4360a4459ad4173940e1323bbcde6cb",
                                "name": "{#SITE} \u2014 Subject alternative name",
                                "type": "DEPENDENT",
                                "key": "cert.alternative_names[{#SITE}]",
                                "delay": "0",
                                "value_type": "TEXT",
                                "trends": "0",
                                "description": "The subject alternative name extension allows identities to be bound to the subject of the certificate.  These identities may be included in addition to or in place of the identity in the subject field of the certificate.  Defined options include an Internet electronic mail address, a DNS name, an IP address, and a Uniform Resource Identifier (URI).",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$.x509.alternative_names"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "web.certificate.get[{#SITE},{$CERT.WEBSITE.PORT},{$CERT.WEBSITE.IP}]"
                                },
                                "tags": [
                                    {
                                        "tag": "component",
                                        "value": "cert"
                                    }
                                ]
                            },
                            {
                                "uuid": "f81dcc9f928f4e4ba58086b818db463a",
                                "name": "{#SITE} \u2014 Issuer",
                                "type": "DEPENDENT",
                                "key": "cert.issuer[{#SITE}]",
                                "delay": "0",
                                "value_type": "TEXT",
                                "trends": "0",
                                "description": "The field identifies the entity that has signed and issued the certificate.",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$.x509.issuer"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "web.certificate.get[{#SITE},{$CERT.WEBSITE.PORT},{$CERT.WEBSITE.IP}]"
                                },
                                "tags": [
                                    {
                                        "tag": "component",
                                        "value": "cert"
                                    }
                                ]
                            },
                            {
                                "uuid": "3680cc9308a746569b1c02fe32c59869",
                                "name": "{#SITE} \u2014 Last validation status",
                                "type": "DEPENDENT",
                                "key": "cert.message[{#SITE}]",
                                "delay": "0",
                                "value_type": "TEXT",
                                "trends": "0",
                                "description": "Last check result message.",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$.result.message"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "web.certificate.get[{#SITE},{$CERT.WEBSITE.PORT},{$CERT.WEBSITE.IP}]"
                                },
                                "tags": [
                                    {
                                        "tag": "component",
                                        "value": "cert"
                                    }
                                ]
                            },
                            {
                                "uuid": "f64037dd9d004b289d7a8df14e902eef",
                                "name": "{#SITE} \u2014 Expires on",
                                "type": "DEPENDENT",
                                "key": "cert.not_after[{#SITE}]",
                                "delay": "0",
                                "units": "unixtime",
                                "description": "The date on which the certificate validity period ends.",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$.x509.not_after.timestamp"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "web.certificate.get[{#SITE},{$CERT.WEBSITE.PORT},{$CERT.WEBSITE.IP}]"
                                },
                                "tags": [
                                    {
                                        "tag": "component",
                                        "value": "cert"
                                    }
                                ],
                                "trigger_prototypes": [
                                    {
                                        "uuid": "c9bf70ed3b1840f7a98b2d376ddff1e2",
                                        "expression": "(last(/Website certificate by Zabbix agent 2/cert.not_after[{#SITE}]) - now()) / 86400 < {$CERT.EXPIRY.WARN}",
                                        "name": "{#SITE} \u2014 SSL certificate expires soon",
                                        "event_name": "{#SITE} \u2014 SSL certificate expires soon (less than {$CERT.EXPIRY.WARN} days)",
                                        "priority": "WARNING",
                                        "description": "The SSL certificate should be updated or it will become untrusted.",
                                        "dependencies": [
                                            {
                                                "name": "{#SITE} \u2014 SSL certificate is invalid",
                                                "expression": "find(/Website certificate by Zabbix agent 2/cert.validation[{#SITE}],,\"like\",\"invalid\")=1"
                                            }
                                        ],
                                        "tags": [
                                            {
                                                "tag": "scope",
                                                "value": "notice"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "uuid": "6cfd305de6c34bbd98319a5f5e3bcccb",
                                "name": "{#SITE} \u2014 Valid from",
                                "type": "DEPENDENT",
                                "key": "cert.not_before[{#SITE}]",
                                "delay": "0",
                                "units": "unixtime",
                                "description": "The date on which the certificate validity period begins.",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$.x509.not_before.timestamp"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "web.certificate.get[{#SITE},{$CERT.WEBSITE.PORT},{$CERT.WEBSITE.IP}]"
                                },
                                "tags": [
                                    {
                                        "tag": "component",
                                        "value": "cert"
                                    }
                                ]
                            },
                            {
                                "uuid": "eed5b1dbe89045bda5987c1ded2cff5f",
                                "name": "{#SITE} \u2014 Public key algorithm",
                                "type": "DEPENDENT",
                                "key": "cert.public_key_algorithm[{#SITE}]",
                                "delay": "0",
                                "value_type": "CHAR",
                                "trends": "0",
                                "description": "The digital signature algorithm is used to verify the signature of a certificate.",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$.x509.public_key_algorithm"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "web.certificate.get[{#SITE},{$CERT.WEBSITE.PORT},{$CERT.WEBSITE.IP}]"
                                },
                                "tags": [
                                    {
                                        "tag": "component",
                                        "value": "cert"
                                    }
                                ]
                            },
                            {
                                "uuid": "275c0178276b4517ad29f75c606797d0",
                                "name": "{#SITE} \u2014 Serial number",
                                "type": "DEPENDENT",
                                "key": "cert.serial_number[{#SITE}]",
                                "delay": "0",
                                "value_type": "CHAR",
                                "trends": "0",
                                "description": "The serial number is a positive integer assigned by the CA to each certificate. It is unique for each certificate issued by a given CA. Non-conforming CAs may issue certificates with serial numbers that are negative or zero.",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$.x509.serial_number"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "web.certificate.get[{#SITE},{$CERT.WEBSITE.PORT},{$CERT.WEBSITE.IP}]"
                                },
                                "tags": [
                                    {
                                        "tag": "component",
                                        "value": "cert"
                                    }
                                ]
                            },
                            {
                                "uuid": "2722282882bd4b6799137d7493ce6971",
                                "name": "{#SITE} \u2014 Fingerprint",
                                "type": "DEPENDENT",
                                "key": "cert.sha1_fingerprint[{#SITE}]",
                                "delay": "0",
                                "value_type": "CHAR",
                                "trends": "0",
                                "description": "The Certificate Signature (SHA1 Fingerprint or Thumbprint) is the hash of the entire certificate in DER form.",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$.sha1_fingerprint"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "web.certificate.get[{#SITE},{$CERT.WEBSITE.PORT},{$CERT.WEBSITE.IP}]"
                                },
                                "tags": [
                                    {
                                        "tag": "component",
                                        "value": "cert"
                                    }
                                ],
                                "trigger_prototypes": [
                                    {
                                        "uuid": "ccbd0e46f26748c79eae5358dddd1c6b",
                                        "expression": "last(/Website certificate by Zabbix agent 2/cert.sha1_fingerprint[{#SITE}]) <> last(/Website certificate by Zabbix agent 2/cert.sha1_fingerprint[{#SITE}],#2)",
                                        "name": "{#SITE} \u2014 Fingerprint has changed",
                                        "event_name": "{#SITE} \u2014 Fingerprint has changed (new version: {ITEM.VALUE})",
                                        "priority": "INFO",
                                        "description": "The SSL certificate fingerprint has changed. If you did not update the certificate, it may mean your certificate has been hacked. Acknowledge to close the problem manually.\nThere could be multiple valid certificates on some installations. In this case, the trigger will have a false positive. You can ignore it or disable the trigger.",
                                        "manual_close": "YES",
                                        "tags": [
                                            {
                                                "tag": "scope",
                                                "value": "notice"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "uuid": "0627d132f7124f98b9351591459459ca",
                                "name": "{#SITE} \u2014 Signature algorithm",
                                "type": "DEPENDENT",
                                "key": "cert.signature_algorithm[{#SITE}]",
                                "delay": "0",
                                "value_type": "CHAR",
                                "trends": "0",
                                "description": "The algorithm identifier for the algorithm used by the CA to sign the certificate.",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$.x509.signature_algorithm"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "web.certificate.get[{#SITE},{$CERT.WEBSITE.PORT},{$CERT.WEBSITE.IP}]"
                                },
                                "tags": [
                                    {
                                        "tag": "component",
                                        "value": "cert"
                                    }
                                ]
                            },
                            {
                                "uuid": "296c1747b9834df8a72a11d489fa6a49",
                                "name": "{#SITE} \u2014 Subject",
                                "type": "DEPENDENT",
                                "key": "cert.subject[{#SITE}]",
                                "delay": "0",
                                "value_type": "TEXT",
                                "trends": "0",
                                "description": "The field identifies the entity associated with the public key stored in the subject public key field.",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$.x509.subject"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "web.certificate.get[{#SITE},{$CERT.WEBSITE.PORT},{$CERT.WEBSITE.IP}]"
                                },
                                "tags": [
                                    {
                                        "tag": "component",
                                        "value": "cert"
                                    }
                                ]
                            },
                            {
                                "uuid": "5dbfe50bafbc422788f9a15e7d0ee5af",
                                "name": "{#SITE} \u2014 Validation result",
                                "type": "DEPENDENT",
                                "key": "cert.validation[{#SITE}]",
                                "delay": "0",
                                "value_type": "CHAR",
                                "trends": "0",
                                "description": "The certificate validation result. Possible values: valid/invalid/valid-but-self-signed",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$.result.value"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "web.certificate.get[{#SITE},{$CERT.WEBSITE.PORT},{$CERT.WEBSITE.IP}]"
                                },
                                "tags": [
                                    {
                                        "tag": "component",
                                        "value": "cert"
                                    }
                                ],
                                "trigger_prototypes": [
                                    {
                                        "uuid": "ce350a87f1004f6cbf5ac496596f5a69",
                                        "expression": "find(/Website certificate by Zabbix agent 2/cert.validation[{#SITE}],,\"like\",\"invalid\")=1",
                                        "name": "{#SITE} \u2014 SSL certificate is invalid",
                                        "priority": "HIGH",
                                        "description": "SSL certificate has expired or it is issued for another domain.",
                                        "tags": [
                                            {
                                                "tag": "scope",
                                                "value": "security"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "uuid": "4b5da9a8fec3424d8e19a7616b0c2016",
                                "name": "{#SITE} \u2014 Version",
                                "type": "DEPENDENT",
                                "key": "cert.version[{#SITE}]",
                                "delay": "0",
                                "value_type": "CHAR",
                                "trends": "0",
                                "description": "The version of the encoded certificate.",
                                "preprocessing": [
                                    {
                                        "type": "JSONPATH",
                                        "parameters": [
                                            "$.x509.version"
                                        ]
                                    }
                                ],
                                "master_item": {
                                    "key": "web.certificate.get[{#SITE},{$CERT.WEBSITE.PORT},{$CERT.WEBSITE.IP}]"
                                },
                                "tags": [
                                    {
                                        "tag": "component",
                                        "value": "cert"
                                    }
                                ]
                            },
                            {
                                "uuid": "83c8bfffb11643fa911d9a35a6fff1f6",
                                "name": "Get {#SITE}",
                                "key": "web.certificate.get[{#SITE},{$CERT.WEBSITE.PORT},{$CERT.WEBSITE.IP}]",
                                "delay": "15m",
                                "history": "0",
                                "value_type": "TEXT",
                                "trends": "0",
                                "description": "Returns the JSON with attributes of a certificate of the requested site.",
                                "preprocessing": [
                                    {
                                        "type": "DISCARD_UNCHANGED_HEARTBEAT",
                                        "parameters": [
                                            "6h"
                                        ]
                                    }
                                ],
                                "tags": [
                                    {
                                        "tag": "component",
                                        "value": "raw"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "tags": [
                    {
                        "tag": "class",
                        "value": "software"
                    },
                    {
                        "tag": "target",
                        "value": "certificate"
                    }
                ],
                "macros": [
                    {
                        "macro": "{$CERT.EXPIRY.WARN}",
                        "value": "7",
                        "description": "Number of days until the certificate expires."
                    },
                    {
                        "macro": "{$CERT.WEBSITE.IP}",
                        "description": "The website IP address for the connection."
                    },
                    {
                        "macro": "{$CERT.WEBSITE.PORT}",
                        "value": "443",
                        "description": "The TLS/SSL port number of the website."
                    }
                ]
            }
        ]
    }
}